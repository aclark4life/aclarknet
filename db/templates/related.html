{% comment %}
  Related items display template
  Uses view configuration from BaseView:
  - related_title_fields: list of field names to show in card title
  - related_excluded_fields: list of field names to never show
  Note: Django's 'in' and 'not in' operators work with lists in templates
{% endcomment %}
{% load text_filters %}
<div class="hr-divider mt-5 mb-3">
  <h3 class="hr-divider-content hr-divider-heading bg-light text-dark">Related</h3>
</div>
<div>{% include 'pagination/index.html' %}</div>

{% for field_values in field_values_page %}
  {% if field_values %}
    {% with model_name=field_values.0.1 object_id=field_values.1.1 %}
      <div
        class="card mb-3"
        onclick="window.location='{% url model_name|add:'_view' object_id %}'"
        style="cursor: pointer; transition: transform 0.3s, box-shadow 0.3s;"
        onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 4px 8px rgba(0,0,0,0.1)';"
        onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
        <div class="card-body">
          <h5 class="card-title">
            <span class="badge" style="background-color: #1997C6">{{ model_name|title }}</span>
            {% for field_name, field_value in field_values %}
              {% if field_name in related_title_fields %}
                {{ field_value|default:"" }}
              {% endif %}
            {% endfor %}
          </h5>
          <div class="card-text">
            {% for field_name, field_value in field_values %}
              {% if field_name not in related_excluded_fields and field_name not in related_title_fields and field_value %}
                <strong>{{ field_name|title_case }}:</strong> {{ field_value|truncatewords:10 }}<br>
              {% endif %}
            {% endfor %}
          </div>
        </div>
      </div>
    {% endwith %}
  {% endif %}
{% endfor %}

<div>{% include 'pagination/index.html' %}</div>
